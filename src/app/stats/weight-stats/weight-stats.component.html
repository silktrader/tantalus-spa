<div class="stat-main">
  <div class="margin">
    <h1>Mood Statistics</h1>

    <form [formGroup]="controls">
      <div class="controls">

        <section>
          <mat-form-field appearance="fill">
            <mat-label>Enter a date range</mat-label>
            <mat-date-range-input [rangePicker]="picker">
              <input matStartDate formControlName="start" placeholder="Start date">
              <input matEndDate formControlName="end" placeholder="End date">
            </mat-date-range-input>
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-date-range-picker #picker></mat-date-range-picker>

            <mat-error *ngIf="controls.controls.start.hasError('matStartDateInvalid')">Invalid start date
            </mat-error>
            <mat-error *ngIf="controls.controls.end.hasError('matEndDateInvalid')">Invalid end date</mat-error>
          </mat-form-field>
        </section>
      </div>
    </form>
  </div>

  <div class="contents">
    <mat-form-field appearance="fill" class="selector">
      <mat-label>Weight Statistics</mat-label>
      <mat-select [formControl]="statSelector">
        <mat-option [value]="weightStat.All">
          All Weight Measurements
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- <section class="loading-notice" *ngIf="(loading$ | async); else stats"> -->
    <section class="loading-notice" *ngIf="(loading$ | async)">
      <h3>Fetching data...</h3>
      <mat-spinner></mat-spinner>
    </section>

    <!-- <ng-template #stats> -->
    <!-- <section *ngIf="showTable$ | async"> -->
    <section [hidden]="(hideTable$ | async) || (loading$ | async)">
      <table mat-table [dataSource]="data" matSort matSortDisableClear matSortDirection="desc"
        matSortActive="measuredOn" class="mat-elevation-z8">

        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
          <td mat-cell *matCellDef="let element"> <a [routerLink]="['/foods/' + element.shortUrl]">{{element.name}}</a>
          </td>
        </ng-container>

        <ng-container matColumnDef="measuredOn">
          <th class="numeric-column" mat-header-cell *matHeaderCellDef mat-sort-header>Date</th>
          <td class="numeric-column" mat-cell *matCellDef="let element"> {{element.measuredOn | date: 'yyyy/MM/dd'}}
          </td>
        </ng-container>

        <ng-container matColumnDef="weight">
          <th class="numeric-column" mat-header-cell *matHeaderCellDef mat-sort-header>Weight (kg)</th>
          <td class="numeric-column" mat-cell *matCellDef="let element"> {{element.weight / 1000 | number: '1.2-2'}}
          </td>
        </ng-container>

        <ng-container matColumnDef="fat">
          <th class="numeric-column" mat-header-cell *matHeaderCellDef mat-sort-header>Body Fat (%)</th>
          <td class="numeric-column" mat-cell *matCellDef="let element"> {{element.fat | number }} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="tableColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: tableColumns;"></tr>
      </table>
      <mat-paginator [length]="dataLength" [pageSize]="15"> </mat-paginator>
    </section>


    <!-- </ng-template> -->
  </div>



</div>